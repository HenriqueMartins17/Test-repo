import pytest
from langchain_core.documents import Document
from loguru import logger

from ai_shared.config import settings
from ai_shared.suggestion import SuggestionProvider, Suggestion

SAMPLE_DOCS = [
    Document(page_content="""
随着全球化和城市化的快速进程，未来的城市设计和发展越来越受到人们的关注。面对环境问题、人口增长和资源短缺等挑战，如何实现城市的可持续发展成为了一个紧迫的议题。本文将探讨未来城市设计的方向和策略，以促进更加可持续和宜居的城市环境。

1. 绿色城市设计
绿色城市设计是未来城市发展的核心方向之一。这包括了建设更多的公共绿地、采用可再生能源和推广低碳出行方式等。通过植树造林、建设生态公园和推广绿色建筑等措施，可以有效减少城市的碳排放，提高空气质量和居民的生活质量。

2. 智能城市技术
随着科技的进步，智能城市技术将成为未来城市设计的重要组成部分。通过引入物联网、人工智能和大数据等先进技术，可以实现城市的智能管理和优化资源配置。例如，智能交通系统可以提高道路利用率，减少交通拥堵和排放；智能能源管理系统可以实现能源的高效利用和低碳生产。

3. 社区参与和共享经济
在未来城市设计中，社区参与和共享经济也将发挥重要作用。通过鼓励居民参与城市规划和管理，可以实现更加民主和包容的城市发展。同时，推广共享经济模式，如共享汽车、共享单车和共享办公空间等，可以提高资源利用率，减少浪费和污染。

4. 城市生态平衡
实现城市的生态平衡是可持续发展的关键。这包括了保护生物多样性、减少生态破坏和推广循环经济等。通过建立生态保护区、恢复湿地和推广可持续农业等措施，可以实现城市与自然环境的和谐共生。

5. 跨界合作和全球联盟
面对全球性的环境和发展挑战，城市之间需要加强跨界合作和建立全球联盟。通过共享知识、经验和资源，可以提高城市的抗风险能力和适应性。同时，鼓励公私合作和跨国投资，可以促进城市间的经济交流和技术创新。

综上所述，未来城市设计与可持续发展是一个复杂而又充满挑战的过程。需要政府、企业和社会各界共同参与，制定合理的政策和措施，实现经济、社会和环境的三重可持续发展。
"""),
    Document(page_content="""
6. 城市规划与空间布局
在未来城市设计中，科学合理的城市规划和空间布局是关键。应该避免过度集中和不均衡的发展，而是通过合理的区域规划和功能分区，实现城市内外部的协调发展。例如，可以发展多中心城市模式，促进区域经济协同和资源共享。

7. 文化遗产与可持续旅游
文化遗产和可持续旅游也是未来城市发展的重要方向。保护和传承历史文化遗产，同时推广文化交流和旅游业，可以实现经济增长和文化传播的双重效益。通过开发文化旅游产品、建设文化遗产保护区和培育文化创意产业等，可以实现文化、经济和社会的和谐发展。

8. 健康城市与公共服务
健康城市和优质的公共服务是实现可持续发展的基础。通过提供高质量的医疗、教育、交通和居住等公共服务，可以满足居民的基本需求，提高生活质量和幸福感。同时，应该加强城市安全和卫生管理，预防和控制疾病传播，保障公共健康和社会稳定。

9. 技术创新与人才培养
技术创新和人才培养是未来城市发展的核心驱动力。通过建立创新体系、支持科技企业和培育高素质人才，可以促进经济结构调整和产业升级。同时，应该加强教育、研究和开发合作，提升城市的创新能力和竞争优势。

10. 风险管理与应急响应
在未来城市设计中，风险管理和应急响应也是不可忽视的问题。面对自然灾害、环境污染和社会冲突等多种风险，需要建立健全的风险评估、预警和应急机制。通过加强监测、预防和救援等措施，可以提高城市的抗风险能力和应急响应效率。

综合以上各方面，未来城市设计与可持续发展需要全面、系统和长远的规划。只有通过政策、技术、人才和社会各方面的综合作用，才能实现经济、社会和环境的可持续发展目标。
"""),
    Document(page_content="""
11. 社会公正与包容性
在未来城市设计中，实现社会公正和包容性是至关重要的。通过建立公平的政策和机制，减少社会贫富差距，提高社会福利和公共服务的覆盖范围，可以促进社会和谐和稳定。同时，应该加强弱势群体的保护和支持，确保所有居民都能享受到城市发展的红利。

12. 生态环境保护与恢复
保护和恢复生态环境是未来城市设计的基础任务。通过加强环境保护、减少污染排放和推广绿色生活方式，可以实现生态系统的健康和稳定。同时，应该鼓励循环利用、节约资源和减少碳足迹，推动生态文明建设和全球环境治理。

13. 文明交流与国际合作
在全球化背景下，文明交流和国际合作也是未来城市发展的重要方向。通过促进文化交流、经济合作和科技创新，可以实现城市之间的互利共赢和共同发展。同时，应该加强国际规则和机制的建设，推动全球治理体系的改革和完善。

14. 人居环境与城市美学
人居环境和城市美学是影响居民生活质量和城市形象的关键因素。通过提高建筑设计、景观规划和公共艺术的质量，可以创建更加宜居、美观和和谐的城市环境。同时，应该注重文化传承、历史保护和地方特色，实现城市的独特魅力和持续吸引力。

15. 透明治理与民主参与
在未来城市设计中，透明治理和民主参与是确保公平公正和人民当家作主的重要途径。通过加强政府公开、社会监督和民众参与，可以实现政策决策的科学、公正和合理。同时，应该推广数字化、网络化和智慧城市建设，提升政务服务和社会治理的效率和效果。

总体而言，未来城市设计与可持续发展是一个综合性、系统性和长期性的工程。需要政府、企业、社会组织和居民共同努力，形成合力，共同实现经济、社会、环境和文化的全面发展和和谐共融。

"""),
    Document(page_content="""
16. 资源管理与节约利用
在未来城市设计和可持续发展中，有效的资源管理和节约利用是不可或缺的环节。随着全球资源日益紧张，如何实现资源的高效利用、循环利用和可持续开发成为一个迫切的问题。通过推广绿色技术、优化供应链和改善生产方式，可以实现资源的最大化利用和减少浪费，确保长期的可持续发展。

17. 教育与培训
教育和培训是提高人力资源质量和促进社会进步的关键手段。在未来城市设计中，应该加强教育体制改革、优化教育资源配置和提升教育质量。同时，应该注重职业培训、技能提升和终身学习，满足经济发展和社会变革的需求。

18. 健康与福利
健康与福利是人民幸福感和社会稳定的基础。在未来城市设计中，应该加强医疗卫生体系建设、提高医疗服务质量和保障公民健康权益。同时，应该建立健全社会保障制度、提供全面福利和支持弱势群体，实现社会公平和正义。

19. 公民参与与社区建设
公民参与和社区建设是实现民主政治和社会和谐的重要途径。在未来城市设计中，应该加强社区自治、提高公民参与度和促进社会团结。通过建立健全社区组织、加强社会服务和发展社区文化，可以实现人民当家作主和社会共建共享。

20. 法治与公正
法治和公正是保障社会稳定和人权保障的基石。在未来城市设计中，应该加强法治建设、完善法律体系和保障司法公正。同时，应该加强法律教育、提高法律意识和维护法律权益，实现社会公平、正义和秩序。

综上所述，未来城市设计与可持续发展需要全面、系统和长远的规划和实施。需要政府、企业、社会组织和居民共同努力，形成合力，共同推动经济、社会、环境、文化和法治的全面发展和和谐共融。
"""),
    Document(page_content="""
21. 技术伦理与人文关怀
随着技术的快速发展和应用，技术伦理和人文关怀在未来城市设计中占据越来越重要的位置。我们不能仅仅追求技术的进步和效率，而忽视其可能带来的伦理和社会问题。因此，应该加强技术伦理教育、建立技术评估机制和保障公众参与，实现技术与人文的和谐发展。

22. 城市交通与基础设施
城市交通和基础设施是支撑城市功能和活力的重要基础。在未来城市设计中，应该优化交通网络、提高交通效率和减少交通拥堵。同时，应该加强基础设施建设、提升供水供电供暖供气能力和保障公共服务，满足城市发展和居民生活的需求。

23. 媒体与传播
媒体和传播在未来城市设计中起到了桥梁和纽带的作用。通过加强媒体监督、提高传播效率和促进信息公开，可以实现社会舆论的公正、公平和公开。同时，应该注重媒体素养、提升公众意识和维护信息安全，确保媒体健康、和谐和可持续发展。

24. 地方与全球
在未来城市设计中，地方与全球的关系日益紧密。城市不仅是地方发展的核心，也是全球合作的重要平台。因此，应该加强地方政府与中央政府、城市与乡村、国内与国际的合作和交流，实现资源共享、风险共担和利益共享，推动地方与全球的互利共赢。

25. 未来愿景与策略
在未来城市设计和可持续发展的道路上，我们需要有明确的愿景和策略。这不仅包括长远的目标和方向，也包括具体的措施和行动计划。因此，应该加强前瞻性研究、制定长远规划和建立实施机制，实现未来城市的绿色、智能、宜居和和谐发展。

总体来说，未来城市设计与可持续发展是一个复杂、多元和全球性的挑战。需要我们不断探索、创新和合作，形成共识、协同努力和共同实现，共建美好、和谐和可持续的未来。
"""),
    Document(page_content="""
26. 社会创新与企业责任
在未来城市设计和可持续发展中，社会创新和企业责任起到了至关重要的作用。企业不仅是经济发展的主体，也是社会责任的承担者。因此，应该鼓励企业创新、提高企业效率和加强企业责任，实现经济效益、社会效益和环境效益的统一和谐。

27. 文化多样性与共享经济
文化多样性和共享经济是未来城市设计和可持续发展的重要组成部分。通过保护文化遗产、促进文化交流和发展文化产业，可以实现文化的繁荣和传承。同时，应该推广共享经济模式、减少资源浪费和提高资源利用效率，实现共享、共赢和可持续的发展。

28. 城市安全与风险管理
城市安全和风险管理是确保人民生命财产安全和社会稳定的基本要求。在未来城市设计中，应该加强公共安全、防灾减灾和应急救援。通过建立健全安全机制、提高公众意识和加强国际合作，可以有效预防和应对各种安全风险和挑战。

29. 数据驱动与智慧决策
在未来城市设计和可持续发展的过程中，数据驱动和智慧决策成为关键。通过收集、分析和利用大数据、人工智能和物联网等先进技术，可以提高决策效率、优化资源配置和满足人民需求。同时，应该加强数据安全、保护个人隐私和维护社会秩序，实现数据驱动、智慧发展和共同繁荣。

30. 持续评估与迭代优化
在未来城市设计和可持续发展的实践中，持续评估和迭代优化是保证质量和效果的关键。应该建立健全评估体系、开展定期评估和进行动态调整，确保政策、措施和项目的有效实施和持续改进。通过不断学习、创新和完善，实现城市的持续进步、人民的幸福生活和社会的和谐稳定。

综合以上各方面，未来城市设计与可持续发展是一个系统性、复杂性和长期性的挑战。需要我们全面、科学和务实地进行规划、实施和评估，共同推动经济、社会、环境和文化的全面发展和和谐共融。
""")
]


class TestSuggestions:
    @pytest.mark.asyncio
    async def test_gen_suggestions_vika(self):
        with settings.set_edition_vika_saas():
            docs: list[Document] = SAMPLE_DOCS
            provider = SuggestionProvider()
            answer = provider.gen_questions_vika(docs)
            assert answer is not None

            questions = Suggestion._process_questions(answer)
            logger.debug(len(questions))
            # sometimes no answer in ci test
            assert len(questions) >= 0
