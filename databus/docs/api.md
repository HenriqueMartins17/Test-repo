```
└── **updateRecords执行函数前**
  └── params(dstId, body(RecordUpdateRo), viewId) (参数)
  └── Guards canActivate(参数校验，判断是否拦截访问)
  └── ApiNotifyInterceptor(未知)
  └── FieldPipe.transform(修改body)
    └── 每个xx.field.ts都有validate+roTransform
└── **updateRecords开始执行函数**
  └── validateRecordExists(校验body的recordid)
  └── meta=getMetaDataByDstId(从数据库获取)
  └── linkDatasheet={}(未知)
  └── datasheet=getDatasheet=loadDatasheetPack(rust的get_datasheet_pack，不过ts有复杂的参数)
  └── checkViewExists(校验viewid)
  └── getFieldUpdateOps(获取参数prependOps)
  └── getUpdateCellOptions(获取参数recordOptions)
  └── datasheet.updateRecords(更新记录)
    └── datasheet.doCommand(执行cmd)
        └── _commandManager.execute(调用mgr)
            └── fullFillOptions(补全参数)
                └── command.execute=setRecords.execute(获取了actions以及op)
                └── _executeActions(执行actions，加入到addUndoStack，收集op)
                    └── didExecutedHook(未知)
                        └── _listener.handleCommandExecuted(未知)
        └── ServerDataStorageProvider.saveOps(未知)
            └── changesets=resourceOpsToChangesets(ops, store.getState())(将IResourceOpsCollect转成changesets)
            └── results=applyDatasheetChangesets(resource.id, changesets, auth, internalFix)(未知)
                └── otService.applyRoomChangeset(message, applyAuth)(未知)
                    └── parseChanges(spaceId, message, cs, auth)(未知)
                    └── getManager().transaction(未知)
                    └── resourceChangeHandler.handleResourceChange(message.roomId, transactions);(未知)
                        └── parseDatasheetResultSet(dstId, effectMap, resultSet)(未知)
                    └── datasheetRecordSubscriptionService.handleChangesets(results, context)(未知)
  └── 条件result.result === ExecuteResult.None(未知)
  └── 条件result.result !== ExecuteResult.Success(返回updateRecords失败信息api_update_error，相同records会触发)
  └── getBasicRecordsByRecordIds(数据库获取参数)
  └── datasheet.resetRecords(同updateRecords，doCommand的参数里多了个store-Redux 是 JavaScript 状态容器)
  └── getNewRecordListVo(获取返回值)
    └── datasheet.getView(数据结构databus.View)
    └── getViewInfo(返回一个结构体{property{view},fieldMap})
       └── getViewById(通过pack获取view)
    └── newView.getRecords(获取records)
    └── getRecordViewObjects(获取recordVos，返回值records)
```